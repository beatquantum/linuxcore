# Nginx Bad User Agent Filter Configuration
# Author: Santosh Pandit, Enhanced by Security Analysis
# Last Update: 07 September 2025
# Purpose: Map malicious or unwanted user agents to $badagent for blocking in model-security-filters.conf.
# Objectives:
# - Block agents used by pentesting tools and malicious bots (mitigates T1595, T1190, T1189).
# - Allow authorized VAPT by commenting out specific rules for red team testing.
# Usage: Store in /etc/nginx/conf.d/badagent.conf and include in server blocks via model-security-filters.conf.
# Note: Periodically review and update the user agent list to include new malicious agents.
# Security Goals:
# - Mitigate T1595 (Active Scanning) by blocking pentesting tools and scanners.
# - Mitigate T1190 (Exploit Public-Facing Application) by preventing automated exploit tools.
# - Mitigate T1189 (Drive-by Compromise) by blocking malicious bots and crawlers.

map $http_user_agent $badagent {
    default 0; # Default to allow (no block) for unrecognized user agents.

    # ============================================================================
    # Security Testing Tools (Block by default; comment out for authorized VAPT)
    # ============================================================================
    # Mitigates T1595 (Active Scanning) and T1190 (Exploit Public-Facing Application).
    ~*acunetix 1; # Acunetix Web Vulnerability Scanner
    ~*burp 1; # Burp Suite
    ~*dirbuster 1; # Directory Buster
    ~*gobuster 1; # GoBuster
    ~*nessus 1; # Nessus Vulnerability Scanner
    ~*nikto 1; # Nikto Web Scanner
    ~*nmap 1; # Nmap Network Scanner
    ~*nuclei 1; # Nuclei Vulnerability Scanner
    ~*openvas 1; # OpenVAS
    ~*retina 1; # Retina Network Scanner
    ~*sqlmap 1; # SQLmap
    ~*w3af 1; # Web Application Attack and Audit Framework
    ~*zap 1; # OWASP ZAP

    # ============================================================================
    # Common Tools (Block by default; comment out for authorized testing)
    # ============================================================================
    # Mitigates T1595; may need unblocking for legitimate use (e.g., DNS-over-HTTPS, APIs).
    # ~*curl 1; # cURL - Used for testing DNS-over-HTTPS, APIs
     ~*java 1; # Java-based clients
     ~*libwww-perl 1; # Perl LWP library
     ~*python 1; # Python-based clients
     ~*python-requests 1; # Python Requests library
     ~*wget 1; # Wget
     ~*wrk 1; # Performance testing tool
     ~*siege 1; # Load testing tool

    # ============================================================================
    # Known Malicious Bots & Crawlers (Always blocked)
    # ============================================================================
    # Mitigates T1595 (Active Scanning) and T1189 (Drive-by Compromise).
    ~*01h4x\.com 1; # Hacking tool
    ~*360spider 1; # Chinese web crawler
    ~*404checker 1; # Scanning bot
    ~*80legs 1; # Web crawler
    ~*abonti 1; # Malicious bot
    ~*backdoor 1; # Backdoor scanner
    ~*barkrowler 1; # Web crawler
    ~*betabot 1; # Malware bot
    ~*blackwidow 1; # Web spider
    ~*blowfish 1; # Scanning bot
    ~*botilot 1; # Malicious bot
    ~*casper 1; # Web crawler
    ~*catexplorador 1; # Web spider
    ~*ccbot 1; # Crawler
    ~*censysinspect 1; # Internet scanning
    ~*cheesebot 1; # Malicious bot
    ~*cherrypicker 1; # Content scraper
    ~*chinaclaw 1; # Chinese crawler
    ~*clshttp 1; # HTTP scanner
    ~*coccocbot-web 1; # Vietnamese crawler
    ~*copier 1; # Content copier
    ~*cosmos 1; # Web crawler
    ~*crawler4j 1; # Java crawler
    ~*crawlera 1; # Web crawler
    ~*crazywebcrawler 1; # Aggressive crawler
    ~*cyotekwebcopy 1; # Website copier
    ~*datacha0s 1; # Malicious bot
    ~*dblbot 1; # Web crawler
    ~*demon 1; # Scanning bot
    ~*devil 1; # Malicious bot
    ~*diavol 1; # Malware bot
    ~*digext 1; # Content extractor
    ~*digincore 1; # Web spider
    ~*disco 1; # Discovery bot
    ~*discoverybot 1; # Web discovery
    ~*dispatch 1; # Bot dispatcher
    ~*dittospyder 1; # Web spider
    ~*easouspider 1; # Chinese crawler
    ~*ecatch 1; # Content grabber
    ~*erocrawler 1; # Web crawler
    ~*evc-batch 1; # Batch crawler
    ~*evil 1; # Malicious bot
    ~*exabot 1; # French crawler
    ~*extractor 1; # Content extractor
    ~*eyenetie 1; # Web spider
    ~*ezooms 1; # Web crawler
    ~*fhscan 1; # Security scanner
    ~*fimap 1; # File inclusion scanner
    ~*flashget 1; # Download manager
    ~*fuzz 1; # Fuzzing tool
    ~*getweb 1; # Web grabber
    ~*gigabot 1; # Web crawler
    ~*grabber 1; # Content grabber
    ~*grafula 1; # Web spider
    ~*grapeshotcrawler 1; # Web crawler
    ~*harvest 1; # Content harvester
    ~*havij 1; # SQL injection tool
    ~*heritrix 1; # Web archiver
    ~*hloader 1; # Content loader
    ~*hydra 1; # Bruteforce
    ~*httrack 1; # Website copier
    ~*ia_archiver 1; # Alexa crawler
    ~*idbot 1; # Identity bot
    ~*ilsebot 1; # Dutch crawler
    ~*ips-agent 1; # IP scanner
    ~*iria 1; # Download manager
    ~*irlbot 1; # Web crawler
    ~*jakarta 1; # Java HTTP client
    ~*jamesbot 1; # Web crawler
    ~*jbrofuzz 1; # Fuzzing tool
    ~*joc 1; # Web spider
    ~*jetcar 1; # Web crawler
    ~*joomla 1; # CMS scanner
    ~*jorgee 1; # Security scanner
    ~*kinza 1; # Web browser bot
    ~*larbin 1; # Web crawler
    ~*leechftp 1; # FTP leech
    ~*leechget 1; # Download manager
    ~*lexibot 1; # Web crawler
    ~*lftp 1; # FTP client
    ~*libweb 1; # Web library
    ~*libwhisker 1; # Security tool
    ~*linkdexbot 1; # SEO crawler
    ~*linkextractorpro 1; # Link extractor
    ~*linkscan 1; # Link checker
    ~*linkwalker 1; # Link crawler
    ~*lwp-trivial 1; # Perl LWP
    ~*magnet 1; # Content grabber
    ~*masscan 1; # Network scanner
    ~*mechanize 1; # Web automation
    ~*medusa 1; # Brute force
    ~*mojolicious 1; # Perl framework
    ~*morfeus 1; # Scanner
    ~*msiecrawler 1; # IE crawler
    ~*muhstik-scan 1; # Malware scanner
    ~*navroad 1; # Web spider
    ~*nearsite 1; # Web crawler
    ~*needle 1; # Security tool
    ~*netants 1; # Download manager
    ~*netcraft 1; # Security survey
    ~*netmechanic 1; # Web tool
    ~*netspider 1; # Web crawler
    ~*netzip 1; # Download manager
    ~*ninja 1; # Web spider
    ~*npbot 1; # Web crawler
    ~*nutch 1; # Apache Nutch
    ~*octopus 1; # Web crawler
    ~*openwebspider 1; # Web crawler
    ~*orangebot 1; # Telecom crawler
    ~*pagegrabber 1; # Page scraper
    ~*panscient 1; # Web crawler
    ~*pavuk 1; # Web mirror
    ~*phpcrawl 1; # PHP crawler
    ~*picscout 1; # Image crawler
    ~*pimonster 1; # Web spider
    ~*pixray 1; # SEO tool
    ~*pockey 1; # Web crawler
    ~*prowebwalker 1; # Web crawler
    ~*psbot 1; # Picture crawler
    ~*pump 1; # Content pump
    ~*queryseekerspider 1; # Web crawler
    ~*reaper 1; # Content reaper
    ~*reget 1; # Download manager
    ~*ripper 1; # Content ripper
    ~*rma 1; # Web spider
    ~*rocketcrawler 1; # Web crawler
    ~*rssingbot 1; # RSS crawler
    ~*s1z\.ru 1; # Malicious bot
    ~*sbidder 1; # Site bidder
    ~*scanalert 1; # Security scanner
    ~*scanbot 1; # Scanning bot
    ~*scrapy 1; # Python Scrapy
    ~*seokicks 1; # SEO tool
    ~*seoprofiler 1; # SEO crawler
    ~*sexsearcher 1; # Adult crawler
    ~*siphon 1; # Content siphon
    ~*sistrix 1; # SEO tool
    ~*sitelockspider 1; # Security crawler
    ~*siteripz 1; # Site ripper
    ~*sitesnagger 1; # Site grabber
    ~*sitesucker 1; # Site copier
    ~*slowhttptest 1; # DoS testing tool
    ~*smartdownload 1; # Download manager
    ~*snake 1; # Web crawler
    ~*snapbot 1; # Snapshot bot
    ~*snoopy 1; # PHP HTTP client
    ~*sogouspider 1; # Chinese crawler
    ~*spammer 1; # Spam bot
    ~*spbot 1; # SEO crawler
    ~*spinn3r 1; # Web indexer
    ~*sqworm 1; # Web crawler
    ~*steeler 1; # Web spider
    ~*superbot 1; # Web crawler
    ~*superhttp 1; # HTTP client
    ~*surfbot 1; # Web surfer
    ~*surveybot 1; # Survey crawler
    ~*suzuran 1; # Web spider
    ~*sysscan 1; # System scanner
    ~*t0phackteam 1; # Hacking group
    ~*takeout 1; # Content grabber
    ~*teleport 1; # Website copier
    ~*telesoft 1; # Web crawler
    ~*thenomad 1; # Web spider
    ~*tighttwatbot 1; # Malicious bot
    ~*tineye 1; # Image crawler
    ~*titan 1; # Web spider
    ~*toata 1; # Web crawler
    ~*turnitinbot 1; # Plagiarism checker
    ~*twice 1; # Web spider
    ~*typhoeus 1; # Ruby HTTP client
    ~*urllib 1; # Python URL lib
    ~*vacuum 1; # Content vacuum
    ~*vagabondo 1; # Web crawler
    ~*vampire 1; # Content sucker
    ~*vci 1; # Web spider
    ~*virusdie 1; # Malware scanner
    ~*voideye 1; # Web crawler
    ~*voilab 1; # Web spider
    ~*voltron 1; # Web crawler
    ~*webauto 1; # Web automation
    ~*webcollage 1; # Content collage
    ~*webcopier 1; # Website copier
    ~*webenhancer 1; # Web tool
    ~*webfetch 1; # Content fetcher
    ~*webleacher 1; # Content leacher
    ~*webreaper 1; # Web reaper
    ~*websucker 1; # Web copier
    ~*webwhacker 1; # Web grabber
    ~*whacker 1; # Content whacker
    ~*whatweb 1; # Web scanner
    ~*winhttrack 1; # Windows HTTrack
    ~*wprecon 1; # WP reconnaissance
    ~*wpscan 1; # WordPress scanner
    ~*www-mechanize 1; # Perl Mechanize
    ~*xaldon 1; # Web spider
    ~*xenu 1; # Link checker
    ~*zade 1; # Web crawler
    ~*zauba 1; # Business crawler
    ~*zeus 1; # Malware bot
    ~*zgrab 1; # Network scanner
    ~*zmeu 1; # Exploit scanner
}
